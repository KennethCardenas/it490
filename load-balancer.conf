<VirtualHost *:80>
    ServerName load-balancer.local
    DocumentRoot /var/www/html

    # Enable mod_status for monitoring
    <Location "/balancer-manager">
        SetHandler balancer-manager
        Require all granted
    </Location>

    <Location "/server-status">
        SetHandler server-status
        Require all granted
    </Location>

    # Define the load balancer cluster
    ProxyPreserveHost On
    
    # Backend servers
    ProxyPass /balancer-manager !
    ProxyPass /server-status !
    
    ProxyPass / balancer://mycluster/
    ProxyPassReverse / balancer://mycluster/

    # Define the cluster with two backend servers
    <Proxy balancer://mycluster>
        # Server A (178.156.159.246)
        BalancerMember http://178.156.159.246:8080 route=serverA
        # Server B (178.156.166.21) 
        BalancerMember http://178.156.166.21:8080 route=serverB
        
        # Load balancing method (byrequests, bytraffic, bybusyness)
        ProxySet lbmethod=byrequests
    </Proxy>

    # Logging for monitoring
    ErrorLog ${APACHE_LOG_DIR}/load_balancer_error.log
    CustomLog ${APACHE_LOG_DIR}/load_balancer_access.log combined
    LogLevel info

</VirtualHost>